{"version":3,"sources":["webpack://keksobooking/./source/js/create-similar-ad.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/upload-images.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/message-when-submit.js","webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/util.js"],"names":["adTemplate","document","querySelector","addDataInTemplate","classTemplateElement","data","adElementTemplate","elementTemplate","classList","add","renameTypeHouse","flat","bungalow","house","palace","filterForm","typeHouse","price","numberRooms","numberGuests","featuresInputs","querySelectorAll","debounceRender","button","_","debounce","doFilter","allAds","render","filters","features","filteredAds","oneAd","length","push","functionRender","addEventListener","value","ad","offer","type","rooms","guests","chosenFeatures","isAdWithChosenFeatures","chosenFeature","includes","featuresInput","checked","indexItem","indexOf","splice","disableFormFields","form","disabledClass","child","children","setAttribute","activateFormFields","remove","removeAttribute","adForm","mapFilter","mapCenterCoordinates","lat","lng","startCoordinatesMainMarker","optionsMainMarker","size","anchor","shadowSize","shadowAnchor","markerOptions","map","L","on","setView","tileLayer","attribution","addTo","mainIcon","icon","iconUrl","iconSize","iconAnchor","shadowUrl","mainMarker","marker","draggable","allMarkers","renderSimilarAd","similarAds","forEach","location","bindPopup","adElement","content","cloneNode","author","avatar","textContent","title","address","renameGuests","checkin","checkout","description","photos","photosList","photoTemlate","removeChild","i","photo","src","appendChild","showImages","element","style","display","item","popup","createElement","innerHTML","createSimilarAd","keepInView","IMAGES_TYPES","avatarChooser","avatarPreview","startAvatarPath","photoChooser","photoPreview","previewUploadImage","fileChooser","preview","altImage","file","files","fileName","name","toLowerCase","matches","some","it","endsWith","hasChildNodes","newFile","width","height","alt","append","reader","FileReader","result","readAsDataURL","minPrice","MAX_NUMBER_ROOMS","inputTypeHouse","inputPrice","inputTitle","inputsTime","min","max","valueLength","setCustomValidity","reportValidity","placeholder","inputRoomNumber","inputCapacity","room","guest","buttonReset","adFormAdress","startAdress","getLatLng","startAdressField","toFixed","evt","target","resetFormField","reset","resetFilter","setLatLng","preventDefault","mainBlock","isEscEvent","key","onSuccess","onFail","ads","renderFunction","filterAds","fetch","then","response","json","catch","placeClass","widthAlert","message","nodeAlertMessage","wrapper","firstChild","transformHtmlToNode","setTimeout","showAlert","popupErrorTemplate","popupError","buttonError","onPopupEscKeydown","closePopupError","removeEventListener","formData","FormData","method","body","responseData","ok","popupSuccessTemplate","popupSuccess","closePopupSuccess"],"mappings":"mBAAA,MAAMA,EAAaC,SAASC,cAAc,SAGpCC,EAAoB,CAACC,EAAsBC,EAAMC,KACrD,MAAMC,EAAkBD,EAAkBJ,cAAcE,GACxD,GAAa,KAATC,EAGF,OAAOA,EAFPE,EAAgBC,UAAUC,IAAI,WAuB5BC,EAAkB,CACtBC,KAAM,WACNC,SAAU,UACVC,MAAO,MACPC,OAAQ,UCzBJC,EAAad,SAASC,cAAc,iBACpCc,EAAYD,EAAWb,cAAc,iBACrCe,EAAQF,EAAWb,cAAc,kBACjCgB,EAAcH,EAAWb,cAAc,kBACvCiB,EAAeJ,EAAWb,cAAc,mBAGxCkB,EADmBL,EAAWb,cAAc,qBACVmB,iBAAiB,SAEnDC,EAAiBC,IACrBA,EAAOC,EAAEC,UACP,IAAMC,KAhBa,OAqBjBC,EAAS,GACf,IAAIC,EAAS,IAAM,KAEnB,MAAMC,EAAU,CACdb,UAAW,KAAM,EACjBC,MAAO,KAAM,EACbC,YAAa,KAAM,EACnBC,aAAc,KAAM,EACpBW,SAAU,KAAM,GAIZJ,EAAW,KACf,MAAMK,EAAc,GAEpB,IAAK,IAAIC,KAASL,EAAQ,CAExB,GAvCqB,KAuCjBI,EAAYE,OACd,MAEEJ,EAAQb,UAAUgB,IACjBH,EAAQZ,MAAMe,IACdH,EAAQX,YAAYc,IACpBH,EAAQV,aAAaa,IACrBH,EAAQC,SAASE,IACpBD,EAAYG,KAAKF,GAIrBJ,EAAOG,IAeTT,GAX0Ba,IACxBnB,EAAUoB,iBAAiB,UAAU,KACX,QAApBpB,EAAUqB,MACZR,EAAQb,UAAY,KAAM,EAE1Ba,EAAQb,UAAYsB,GAAMtB,EAAUqB,QAAUC,EAAGC,MAAMC,KAGzDL,UA0BJb,GArBsBa,IACpBlB,EAAMmB,iBAAiB,UAAU,KAC/B,OAAQnB,EAAMoB,OACZ,IAAK,SACHR,EAAQZ,MAAQqB,GAAMA,EAAGC,MAAMtB,OArErB,KAqE2CqB,EAAGC,MAAMtB,OApEpD,IAqEV,MACF,IAAK,MACHY,EAAQZ,MAAQqB,GAAMA,EAAGC,MAAMtB,MAxErB,IAyEV,MACF,IAAK,OACHY,EAAQZ,MAAQqB,GAAMA,EAAGC,MAAMtB,MA1ErB,IA2EV,MAEF,QACEY,EAAQZ,MAAQ,KAAM,EAI1BkB,UAgBJb,GAXsBa,IACpBjB,EAAYkB,iBAAiB,UAAU,KACX,QAAtBlB,EAAYmB,MACdR,EAAQX,YAAc,KAAM,EAE5BW,EAAQX,YAAcoB,GAAMA,EAAGC,MAAME,SAAWvB,EAAYmB,MAG9DF,UAgBJb,GAXuBa,IACrBhB,EAAaiB,iBAAiB,UAAU,KACX,QAAvBjB,EAAakB,MACfR,EAAQV,aAAe,KAAM,EAE7BU,EAAQV,aAAemB,GAAMA,EAAGC,MAAMG,UAAYvB,EAAakB,MAGjEF,UAMJ,MAAMQ,EAAiB,GACjBC,EAAyBN,IAC7B,GAA8B,IAA1BK,EAAeV,OACjB,OAAO,EAET,IAAK,IAAIY,KAAiBF,EACxB,IAAKL,EAAGC,MAAMT,SAASgB,SAASD,GAC9B,OAAO,EAGX,OAAO,GAmBTvB,GAhByBa,IACvB,IAAK,IAAIY,KAAiB3B,EACxB2B,EAAcX,iBAAiB,UAAU,KAGvC,GAFAP,EAAQC,SAAWc,EAEfG,EAAcC,QAChBL,EAAeT,KAAKa,EAAcV,WAC7B,CACL,MAAMY,EAAYN,EAAeO,QAAQH,EAAcV,OACvDM,EAAeQ,OAAOF,EAAW,GAGnCd,UAON,MCjJMiB,EAAoB,CAACC,EAAMC,KAC/BD,EAAK7C,UAAUC,IAAI6C,GAGnB,IAAK,IAAIC,KAASF,EAAKG,SACrBD,EAAME,aAAa,WAAY,aAI7BC,EAAqB,CAACL,EAAMC,KAChCD,EAAK7C,UAAUmD,OAAOL,GACtB,IAAK,IAAIC,KAASF,EAAKG,SACrBD,EAAMK,gBAAgB,aAKpBC,EAAS5D,SAASC,cAAc,YAChC4D,EAAY/C,EAEZgD,EAAuB,CAAEC,IAAK,QAASC,IAAK,WAC5CC,EAA6BH,EAE7BI,EAAoB,CACxBC,KAAM,CAAC,GAAI,IACXC,OAAQ,CAAC,GAAI,IACbC,WAAY,CAAC,GAAI,IACjBC,aAAc,CAAC,GAAI,KAEfC,EAAgB,CACpBJ,KAAM,CAAC,GAAI,IACXC,OAAQ,CAAC,GAAI,IACbC,WAAY,CAAC,GAAI,IACjBC,aAAc,CAAC,EAAG,KAKpBnB,EAAkBS,EAAQ,qBAC1BT,EAAkBU,EAAW,0BAG7B,MAAMW,EAAMC,EAAED,IAAI,cACfE,GAAG,QAAQ,KACVjB,EAAmBG,EAAQ,qBAC3BH,EAAmBI,EAAW,6BAE/Bc,QAAQb,EAAsB,IAGjCW,EAAEG,UACA,qDACA,CACEC,YAAa,4FAEfC,MAAMN,GAGR,MAAMO,EAAWN,EAAEO,KAAK,CACtBC,QAAS,mBACTC,SAAUhB,EAAkBC,KAC5BgB,WAAYjB,EAAkBE,OAC9BgB,UAAW,mCACXf,WAAYH,EAAkBG,WAC9BC,aAAcJ,EAAkBI,eAG5Be,EAAaZ,EAAEa,OACnBrB,EACA,CACEsB,WAAW,EACXP,KAAMD,IAGVM,EAAWP,MAAMN,GAGjB,MAAMQ,EAAOP,EAAEO,KAAK,CAClBC,QAAS,cACTC,SAAUX,EAAcJ,KACxBgB,WAAYZ,EAAcH,OAC1BgB,UAAW,mCACXf,WAAYE,EAAcF,WAC1BC,aAAcC,EAAcD,eAIxBkB,EAAa,GASbC,EAAmBC,IANvBF,EAAWG,SAAQL,IACjBA,EAAO5B,YAET8B,EAAWxD,OAAS,EAMpB0D,EAAWC,SAAQtD,IACjB,MAAMiD,EAASb,EAAEa,OACf,CACEvB,IAAK1B,EAAGuD,SAAS7B,IACjBC,IAAK3B,EAAGuD,SAAS5B,KAEnB,CACEgB,KAAMA,IAIVM,EACGR,MAAMN,GACNqB,UFvEiBxD,KAEtB,MAAMyD,EAAY/F,EAAWgG,QAAQC,WAAU,GAtC7B5F,MAwClB0F,EAAU7F,cAAc,kBAAkBuD,aAAa,MAAOnB,EAAG4D,OAAOC,QACxEJ,EAAU7F,cAAc,iBAAiBkG,YAAcjG,EAAkB,gBAAiBmC,EAAGC,MAAM8D,MAAON,GAC1GA,EAAU7F,cAAc,yBAAyBkG,YAAcjG,EAAkB,wBAAyBmC,EAAGC,MAAM+D,QAASP,GAC5HA,EAAU7F,cAAc,UAAUkG,YAAcjG,EAAkB,sBAAuBmC,EAAGC,MAAMtB,MAAO8E,GACzGA,EAAU7F,cAAc,gBAAgBkG,YAAc1F,EAAgB4B,EAAGC,MAAMC,MAC/EuD,EAAU7F,cAAc,0BAA0BkG,cA7ChC/F,EA6C0DF,EAAkB,yBAA0BmC,EAAGC,MAAME,MAAOsD,IA5C7H,IAAO,GAAc,KAAT1F,EACdA,EAAO,WAEZA,EAAO,IAAM,GAAKA,EAAO,IAAO,GAAc,KAATA,EAChCA,EAAO,UAETA,EAAO,YAsCwI,QAnCnIA,IACfA,EAAO,IAAO,GAAc,KAATA,EACdA,EAAO,SAETA,EAAO,UA+BkJkG,CAAapG,EAAkB,yBAA0BmC,EAAGC,MAAMG,OAAQqD,IAC1OA,EAAU7F,cAAc,sBAAsBkG,YAAc,eAAiBjG,EAAkB,qBAAsBmC,EAAGC,MAAMiE,QAAST,GAAa,cAAgB5F,EAAkB,qBAAsBmC,EAAGC,MAAMkE,SAAUV,GAC/NA,EAAU7F,cAAc,uBAAuBkG,YAAcjG,EAAkB,sBAAuBmC,EAAGC,MAAMmE,YAAaX,GAvB3G,EAACY,EAAQrG,KAC1B,MAAMsG,EAAatG,EAAkBJ,cAAc,kBAC7C2G,EAAevG,EAAkBJ,cAAc,iBACrD0G,EAAWE,YAAYD,GAEvBF,EAAOf,SAAQ,CAACpE,EAAGuF,KACjB,MAAMC,EAAQH,EAAaZ,YAC3Be,EAAMC,IAAMN,EAAOI,GACnBH,EAAWM,YAAYF,OAgBzBG,CAAW7E,EAAGC,MAAMoE,OAAQZ,GAE5BA,EAAU1E,iBAAiB,mBAAmBuE,SAASwB,IACrDA,EAAQC,MAAMC,QAAU,UAE1BhF,EAAGC,MAAMT,SAAS8D,SAAQ2B,IACxBxB,EAAU7F,cAAc,oBAAoBqH,KAAQF,MAAMC,QAAU,kBAGtE,MAAME,EAAQvH,SAASwH,cAAc,OAGrC,OAFAD,EAAMN,YAAYnB,GAEXyB,EAAME,WEgDPC,CAAgBrF,GAChB,CACEsF,YAAY,IAIlBnC,EAAWvD,KAAKqD,OC9HdsC,EAAe,CAAC,MAAO,OAAQ,OAE/BC,EAAgB7H,SAASC,cAAc,WACvC6H,EAAgB9H,SAASC,cAAc,4BACvC8H,EAAkBD,EAAcvE,SAAS,GAAGyD,IAE5CgB,EAAehI,SAASC,cAAc,WACtCgI,EAAejI,SAASC,cAAc,mBAEtCiI,EAAqB,CAACC,EAAaC,EAASC,KAChDF,EAAYhG,iBAAiB,UAAU,KACrC,MAAMmG,EAAOH,EAAYI,MAAM,GACzBC,EAAWF,EAAKG,KAAKC,cAErBC,EAAUf,EAAagB,MAAMC,GAC1BL,EAASM,SAASD,KAG3B,IAAKT,EAAQW,gBAAiB,CAC5B,MAAMC,EAAUhJ,SAASwH,cAAc,OACvCwB,EAAQ5B,MAAM6B,MAAQ,OACtBD,EAAQ5B,MAAM8B,OAAS,OACvBF,EAAQG,IAAMd,EACdD,EAAQgB,OAAOJ,GAGjB,GAAIL,EAAS,CACX,MAAMU,EAAS,IAAIC,WAEnBD,EAAOlH,iBAAiB,QAAQ,KAC9BiG,EAAQ7E,SAAS,GAAGyD,IAAMqC,EAAOE,UAGnCF,EAAOG,cAAclB,QAY3BJ,EAAmBL,EAAeC,GAClCI,EAAmBF,EAAcC,EAAc,oBC1C/C,MAGMwB,EAAW,CACf9I,SAAU,EACVD,KAAM,IACNE,MAAO,IACPC,OAAQ,KAEJ,EAAY,IAGZ6I,EAAmB,IAGnB,EAAS1J,SAASC,cAAc,YAKhC0J,EAAiB,EAAO1J,cAAc,SACtC2J,EAAa,EAAO3J,cAAc,UAClC4J,EAAa,EAAO5J,cAAc,UAElC6J,EADW,EAAO7J,cAAc,2BACVmB,iBAAiB,UAE7CyI,EAAW1H,iBAAiB,SAAS,KACnC0H,EAAWE,IA3BY,GA4BvBF,EAAWG,IA3BY,IA6BvB,MAAMC,EAAcJ,EAAWzH,MAAMJ,OAEjCiI,EAhCmB,GAiCrBJ,EAAWK,kBAAkB,QAjCR,GAiCqCD,GAAe,UAChEA,EAjCY,IAkCrBJ,EAAWK,kBAAkB,mBAAqBD,EAlC7B,KAkC+D,UAEpFJ,EAAWK,kBAAkB,IAG/BL,EAAWM,oBAIbR,EAAexH,iBAAiB,UAAU,KACxCyH,EAAWQ,YAAcX,EAASE,EAAevH,OACjDwH,EAAWG,IAAMN,EAASE,EAAevH,OACzCwH,EAAWI,IAAM,KAGnBJ,EAAWzH,iBAAiB,SAAS,KACnCyH,EAAWQ,YAAcX,EAASE,EAAevH,OACjDwH,EAAWG,IAAMN,EAASE,EAAevH,OACzCwH,EAAWI,IAAM,KAGnBF,EAAW,GAAG3H,iBAAiB,SAAS,KACtC2H,EAAW,GAAG1H,MAAQ0H,EAAW,GAAG1H,SAGtC0H,EAAW,GAAG3H,iBAAiB,SAAS,KACtC2H,EAAW,GAAG1H,MAAQ0H,EAAW,GAAG1H,SAOtC,MAAMiI,EAAkB,EAAOpK,cAAc,gBACvCqK,EAAgB,EAAOrK,cAAc,aAE3CoK,EAAgBlI,iBAAiB,SAAS,KACxC,MAAMoI,GAASF,EAAqB,MAC9BG,GAAUF,EAAmB,MAE/BC,GAAQb,GAAoBc,EAhEhB,EAiEdF,EAAcJ,kBAAkB,yCACvBK,EAAOb,GAlEF,IAkEsBc,EACpCF,EAAcJ,kBAAkB,8BACvBK,EAAOC,GAASA,EAAQd,EACjCY,EAAcJ,kBAAkB,yCAEhCI,EAAcJ,kBAAkB,OAIpCI,EAAcnI,iBAAiB,SAAS,KACtC,MAAMoI,GAASF,EAAqB,MAC9BG,GAAUF,EAAmB,OAE/BC,EAAOb,GAAoBc,EA/Ef,GA+EoCD,GAAQC,GAEjDD,GAAQb,GAjFH,IAiFuBc,IADrCF,EAAcJ,kBAAkB,IAK9BK,GAAQb,GAAoBc,EArFhB,EAsFdF,EAAcJ,kBAAkB,yCACvBK,EAAOb,GAvFF,IAuFsBc,EACpCF,EAAcJ,kBAAkB,yCACvBK,EAAOC,GAASA,EAAQd,GACjCY,EAAcJ,kBAAkB,4CASpC,MAAMO,EAAczK,SAASC,cAAc,mBACrCyK,EAAe,EAAOzK,cAAc,YAC1CyK,EAAalH,aAAa,WAAY,YAEtC,MAAMmH,EAActF,EAAWuF,YACzBC,EAAmB,GAAGF,EAAY5G,IAAI+G,QAAQ,OAAOH,EAAY3G,IAAI8G,QAAQ,KACnFJ,EAAatI,MAAQyI,EAErBxF,EAAWX,GAAG,QAASqG,IACrBL,EAAatI,MAAQ,GAAG2I,EAAIC,OAAOJ,YAAY7G,IAAI+G,QAAQ,OAAOC,EAAIC,OAAOJ,YAAY5G,IAAI8G,QAAQ,QAGvG,MAAMG,EAAiB,KACrB,EAAOC,QHgCW,MAClBpK,EAAWoK,QACX,IAAK,IAAI5D,KAAQ1F,EACfA,EAAQ0F,GAAQ,KAAM,EAExB7F,KGpCA0J,GACAT,EAAatI,MAAQyI,EACrBxF,EAAW+F,UAAUT,GD3FrB1C,EAAaR,UAAY,GACzBK,EAAcvE,SAAS,GAAGyD,IAAMe,GC8FlC0C,EAAYtI,iBAAiB,SAAS4I,IACpCA,EAAIM,iBACJJ,OCtIF,MAAMK,GAAYtL,SAASC,cAAc,QAEnCsL,GAAcR,GACC,WAAZA,EAAIS,KAAgC,QAAZT,EAAIS,ICOrBC,OAasBC,GAbtBD,GAmCRE,ILyGU,EAACA,EAAKC,KACtBlK,EAAOO,QAAQ0J,GACfhK,EAASiK,EACTnK,KK3GAoK,CAAUF,EAAKlG,IAnCfqG,MAL2B,yDAMxBC,MAAKC,GAAYA,EAASC,SAC1BF,MAAKJ,IACJF,GAAUE,MAEXO,OAAM,KCMO,EAACC,EAAYC,EAAYC,KACzC,MAIMC,EAXoB,CAACnF,IAC3B,MAAMoF,EAAUvM,SAASwH,cAAc,OAEvC,OADA+E,EAAQ9E,UAAYN,EACboF,EAAQC,YAQUC,CAJJ,0DAA0DL,kGAE/CC,WAGhCrM,SAASC,cAAckM,GAAY/C,OAAOkD,GAE1CI,YAAW,KACTJ,EAAiB5I,WAChB,MDfCiJ,CAAU,eAAgB,OAAQ,uDAClCxJ,EAAkBrC,EAAY,6BAKE4K,GDWZ,KACxB,MAAMkB,EAAqB5M,SAASC,cAAc,UAAU8F,QAAQC,WAAU,GACxE6G,EAAa7M,SAASwH,cAAc,OAC1CqF,EAAW5F,YAAY2F,GACvBtB,GAAUrE,YAAY4F,GAEtB,MAAMC,EAAc9M,SAASC,cAAc,kBAErC8M,EAAqBhC,IACrBQ,GAAWR,KACbA,EAAIM,iBACJ2B,MAIEA,EAAkB,KACtBH,EAAWtM,UAAUC,IAAI,UACzBR,SAASiN,oBAAoB,UAAWF,IAG1CD,EAAY3K,iBAAiB,SAAS,KACpC6K,OAGFhN,SAASmC,iBAAiB,UAAW4K,GAErCF,EAAW1K,iBAAiB,SAAS,KACnC6K,QCrCF,mBAAwB,UAAUjC,IAChCA,EAAIM,iBAEJ,MAAM6B,EAAW,IAAIC,SAASpC,EAAIC,QAElCc,MAtB4B,mDAwB1B,CACEsB,OAAQ,OACRC,KAAMH,IAERnB,MAAKuB,IACLA,EAAaC,GD7BU,MAC3B,MAAMC,EAAuBxN,SAASC,cAAc,YAAY8F,QAAQC,WAAU,GAC5EyH,EAAezN,SAASwH,cAAc,OAC5CiG,EAAaxG,YAAYuG,GACzBlC,GAAUrE,YAAYwG,GAEtB,MAAMV,EAAqBhC,IACrBQ,GAAWR,KACbA,EAAIM,iBACJqC,MAIEA,EAAoB,KACxBzC,IACAwC,EAAalN,UAAUC,IAAI,UAC3BR,SAASiN,oBAAoB,UAAWF,IAI1C/M,SAASmC,iBAAiB,UAAW4K,GAErCU,EAAatL,iBAAiB,SAAS,KACrCuL,QCMoBjC,GAAoBC,QAErCQ,OAAM,KACLR,Y","file":"main.bundle.js","sourcesContent":["const adTemplate = document.querySelector('#card');\n\n// Незачет Б1.3. Вот функция для проверки на неполные данные. Ниже (в createSimilarAd) она используется для каждого поля\nconst addDataInTemplate = (classTemplateElement, data, adElementTemplate) => {\n  const elementTemplate = adElementTemplate.querySelector(classTemplateElement);\n  if (data === '') {\n    elementTemplate.classList.add('hidden');\n  } else {\n    return data;\n  }\n};\n\nconst renameRooms = data => {\n  if (data % 10 === 1 && data !== 11) {\n    return data + ' комната';\n  }\n  if (data % 10 >= 5 || data % 10 === 0 || data === 11) {\n    return data + ' комнат';\n  }\n  return data + ' комнаты';\n};\n\nconst renameGuests = data => {\n  if (data % 10 === 1 && data !== 11) {\n    return data + ' гостя';\n  }\n  return data + ' гостей';\n};\n\nconst renameTypeHouse = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\nconst showImages = (photos, adElementTemplate) => {\n  const photosList = adElementTemplate.querySelector('.popup__photos');\n  const photoTemlate = adElementTemplate.querySelector('.popup__photo');\n  photosList.removeChild(photoTemlate);\n\n  photos.forEach((_, i) => {\n    const photo = photoTemlate.cloneNode();\n    photo.src = photos[i];\n    photosList.appendChild(photo);\n  });\n};\n\nconst createSimilarAd = ad => {\n\n  const adElement = adTemplate.content.cloneNode(true);\n\n  adElement.querySelector('.popup__avatar').setAttribute('src', ad.author.avatar);\n  adElement.querySelector('.popup__title').textContent = addDataInTemplate('.popup__title', ad.offer.title, adElement);\n  adElement.querySelector('.popup__text--address').textContent = addDataInTemplate('.popup__text--address', ad.offer.address, adElement);\n  adElement.querySelector('.price').textContent = addDataInTemplate('.popup__text--price', ad.offer.price, adElement);\n  adElement.querySelector('.popup__type').textContent = renameTypeHouse[ad.offer.type];\n  adElement.querySelector('.popup__text--capacity').textContent = renameRooms(addDataInTemplate('.popup__text--capacity', ad.offer.rooms, adElement)) + ' для ' + renameGuests(addDataInTemplate('.popup__text--capacity', ad.offer.guests, adElement));\n  adElement.querySelector('.popup__text--time').textContent = 'Заезд после ' + addDataInTemplate('.popup__text--time', ad.offer.checkin, adElement) + ', выезд до ' + addDataInTemplate('.popup__text--time', ad.offer.checkout, adElement);\n  adElement.querySelector('.popup__description').textContent = addDataInTemplate('.popup__description', ad.offer.description, adElement);\n  showImages(ad.offer.photos, adElement);\n\n  adElement.querySelectorAll('.popup__feature').forEach((element) => {\n    element.style.display = 'none';\n  });\n  ad.offer.features.forEach(item => {\n    adElement.querySelector(`.popup__feature--${item}`).style.display = 'inline-block';\n  })\n\n  const popup = document.createElement('div');\n  popup.appendChild(adElement);\n\n  return popup.innerHTML;\n};\n\nexport { createSimilarAd };\n","/* global _:readonly */\n\nconst SIMILAR_AD_COUNT = 10;\nconst RERENDER_DELAY = 500;\n\nconst MIN_PRICE = 10000;\nconst MAX_PRICE = 50000;\n\nconst filterForm = document.querySelector('.map__filters');\nconst typeHouse = filterForm.querySelector('#housing-type');\nconst price = filterForm.querySelector('#housing-price');\nconst numberRooms = filterForm.querySelector('#housing-rooms');\nconst numberGuests = filterForm.querySelector('#housing-guests');\n\nconst featuresFieldset = filterForm.querySelector('#housing-features');\nconst featuresInputs = featuresFieldset.querySelectorAll('input');\n\nconst debounceRender = button => {\n  button(_.debounce(\n    () => doFilter(),\n    RERENDER_DELAY,\n  ))\n};\n\nconst allAds = [];\nlet render = () => null;\n\nconst filters = {\n  typeHouse: () => true,\n  price: () => true,\n  numberRooms: () => true,\n  numberGuests: () => true,\n  features: () => true,\n};\n\n\nconst doFilter = () => {\n  const filteredAds = [];\n\n  for (let oneAd of allAds) {\n\n    if (filteredAds.length === SIMILAR_AD_COUNT) {\n      break;\n    }\n    if (filters.typeHouse(oneAd)\n      && filters.price(oneAd)\n      && filters.numberRooms(oneAd)\n      && filters.numberGuests(oneAd)\n      && filters.features(oneAd)) {\n      filteredAds.push(oneAd);\n    }\n  }\n\n  render(filteredAds);\n};\n\n\nconst onTypeHouseClick = (functionRender) => {\n  typeHouse.addEventListener('change', () => {\n    if (typeHouse.value === 'any') {\n      filters.typeHouse = () => true;\n    } else {\n      filters.typeHouse = ad => typeHouse.value === ad.offer.type;\n    }\n\n    functionRender();\n  });\n}\ndebounceRender(onTypeHouseClick);\n\nconst onPriceClick = (functionRender) => {\n  price.addEventListener('change', () => {\n    switch (price.value) {\n      case 'middle':\n        filters.price = ad => ad.offer.price >= MIN_PRICE && ad.offer.price <= MAX_PRICE;\n        break;\n      case 'low':\n        filters.price = ad => ad.offer.price < MIN_PRICE;\n        break;\n      case 'high':\n        filters.price = ad => ad.offer.price > MAX_PRICE;\n        break;\n\n      default:\n        filters.price = () => true;\n        break;\n    }\n\n    functionRender();\n  });\n}\ndebounceRender(onPriceClick);\n\nconst onRoomsClick = (functionRender) => {\n  numberRooms.addEventListener('change', () => {\n    if (numberRooms.value === 'any') {\n      filters.numberRooms = () => true;\n    } else {\n      filters.numberRooms = ad => ad.offer.rooms === +numberRooms.value;\n    }\n\n    functionRender();\n  });\n}\ndebounceRender(onRoomsClick);\n\nconst onGuestsClick = (functionRender) => {\n  numberGuests.addEventListener('change', () => {\n    if (numberGuests.value === 'any') {\n      filters.numberGuests = () => true;\n    } else {\n      filters.numberGuests = ad => ad.offer.guests === +numberGuests.value;\n    }\n\n    functionRender();\n  });\n}\ndebounceRender(onGuestsClick);\n\n\nconst chosenFeatures = [];\nconst isAdWithChosenFeatures = ad => {\n  if (chosenFeatures.length === 0) {\n    return true;\n  }\n  for (let chosenFeature of chosenFeatures) {\n    if (!ad.offer.features.includes(chosenFeature)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nconst onFeaturesClick = (functionRender) => {\n  for (let featuresInput of featuresInputs) {\n    featuresInput.addEventListener('change', () => {\n      filters.features = isAdWithChosenFeatures;\n\n      if (featuresInput.checked) {\n        chosenFeatures.push(featuresInput.value);\n      } else {\n        const indexItem = chosenFeatures.indexOf(featuresInput.value);\n        chosenFeatures.splice(indexItem, 1);\n      }\n\n      functionRender();\n    })\n  }\n}\ndebounceRender(onFeaturesClick);\n\n\nconst filterAds = (ads, renderFunction) => {\n  allAds.push(...ads);\n  render = renderFunction;\n  doFilter();\n}\n\n\nconst resetFilter = () => {\n  filterForm.reset();\n  for (let item in filters) {\n    filters[item] = () => true;\n  }\n  doFilter();\n}\n\n\nexport { filterForm, filterAds, resetFilter };\n","/* global L:readonly */\n\nimport { createSimilarAd } from './create-similar-ad.js';\nimport { filterForm } from './filter.js';\n\n\n\nconst disableFormFields = (form, disabledClass) => {\n  form.classList.add(disabledClass);\n\n  // Не использовала forEach, т.к. этот метод не работает на коллекциях HTML (.children)\n  for (let child of form.children) {\n    child.setAttribute('disabled', 'disabled');\n  }\n};\n\nconst activateFormFields = (form, disabledClass) => {\n  form.classList.remove(disabledClass);\n  for (let child of form.children) {\n    child.removeAttribute('disabled');\n  }\n};\n\n\nconst adForm = document.querySelector('.ad-form');\nconst mapFilter = filterForm;\n\nconst mapCenterCoordinates = { lat: 35.6895, lng: 139.69171 };\nconst startCoordinatesMainMarker = mapCenterCoordinates;\n\nconst optionsMainMarker = {\n  size: [40, 40],\n  anchor: [20, 40],\n  shadowSize: [35, 35],\n  shadowAnchor: [10, 35],\n};\nconst markerOptions = {\n  size: [30, 30],\n  anchor: [15, 30],\n  shadowSize: [30, 30],\n  shadowAnchor: [8, 30],\n};\n\n\n\ndisableFormFields(adForm, 'ad-form--disabled');\ndisableFormFields(mapFilter, 'map__filters--disabled');\n\n\nconst map = L.map('map-canvas')\n  .on('load', () => {\n    activateFormFields(adForm, 'ad-form--disabled');\n    activateFormFields(mapFilter, 'map__filters--disabled');\n  })\n  .setView(mapCenterCoordinates, 10);\n\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\n\nconst mainIcon = L.icon({\n  iconUrl: 'img/main-pin.svg',\n  iconSize: optionsMainMarker.size,\n  iconAnchor: optionsMainMarker.anchor,\n  shadowUrl: 'leaflet/images/marker-shadow.png',\n  shadowSize: optionsMainMarker.shadowSize,\n  shadowAnchor: optionsMainMarker.shadowAnchor,\n});\n\nconst mainMarker = L.marker(\n  startCoordinatesMainMarker,\n  {\n    draggable: true,\n    icon: mainIcon,\n  },\n);\nmainMarker.addTo(map);\n\n\nconst icon = L.icon({\n  iconUrl: 'img/pin.svg',\n  iconSize: markerOptions.size,\n  iconAnchor: markerOptions.anchor,\n  shadowUrl: 'leaflet/images/marker-shadow.png',\n  shadowSize: markerOptions.shadowSize,\n  shadowAnchor: markerOptions.shadowAnchor,\n});\n\n\nconst allMarkers = [];\n\nconst clearAllMarkers = () => {\n  allMarkers.forEach(marker => {\n    marker.remove();\n  })\n  allMarkers.length = 0;\n}\n\nconst renderSimilarAd = (similarAds) => {\n  clearAllMarkers();\n\n  similarAds.forEach(ad => {\n    const marker = L.marker(\n      {\n        lat: ad.location.lat,\n        lng: ad.location.lng,\n      },\n      {\n        icon: icon,\n      },\n    );\n\n    marker\n      .addTo(map)\n      .bindPopup(\n        createSimilarAd(ad),\n        {\n          keepInView: true,\n        },\n      );\n\n    allMarkers.push(marker);\n  });\n};\n\n\nexport { renderSimilarAd, disableFormFields, mainMarker };\n","const IMAGES_TYPES = ['jpg', 'jpeg', 'png'];\n\nconst avatarChooser = document.querySelector('#avatar');\nconst avatarPreview = document.querySelector('.ad-form-header__preview');\nconst startAvatarPath = avatarPreview.children[0].src;\n\nconst photoChooser = document.querySelector('#images');\nconst photoPreview = document.querySelector('.ad-form__photo');\n\nconst previewUploadImage = (fileChooser, preview, altImage) => {\n  fileChooser.addEventListener('change', () => {\n    const file = fileChooser.files[0];\n    const fileName = file.name.toLowerCase();\n\n    const matches = IMAGES_TYPES.some((it) => {\n      return fileName.endsWith(it);\n    });\n\n    if (!preview.hasChildNodes()) {\n      const newFile = document.createElement('img');\n      newFile.style.width = '100%';\n      newFile.style.height = '100%';\n      newFile.alt = altImage;\n      preview.append(newFile);\n    }\n\n    if (matches) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        preview.children[0].src = reader.result;\n      });\n\n      reader.readAsDataURL(file);\n    }\n  });\n};\n\nconst resetImageForm = () => {\n  photoPreview.innerHTML = '';\n  avatarPreview.children[0].src = startAvatarPath;\n}\n\n\n\npreviewUploadImage(avatarChooser, avatarPreview);\npreviewUploadImage(photoChooser, photoPreview, 'Фотография жилья');\n\nexport { resetImageForm };\n","import { mainMarker } from './map.js';\nimport { resetFilter } from './filter.js';\nimport { resetImageForm } from './upload-images.js';\n\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\n\nconst minPrice = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n};\nconst MAX_PRICE = 1000000;\n\nconst NO_GUESTS = 0;\nconst MAX_NUMBER_ROOMS = 100;\n\n\nconst adForm = document.querySelector('.ad-form');\n\n\n//Валидация полей (заголовок, тип жилья и цена, время)\n\nconst inputTypeHouse = adForm.querySelector('#type');\nconst inputPrice = adForm.querySelector('#price');\nconst inputTitle = adForm.querySelector('#title');\nconst formTime = adForm.querySelector('.ad-form__element--time');\nconst inputsTime = formTime.querySelectorAll('select');\n\ninputTitle.addEventListener('input', () => {\n  inputTitle.min = MIN_TITLE_LENGTH;\n  inputTitle.max = MAX_TITLE_LENGTH;\n\n  const valueLength = inputTitle.value.length;\n\n  if (valueLength < MIN_TITLE_LENGTH) {\n    inputTitle.setCustomValidity('Ещё ' + (MIN_TITLE_LENGTH - valueLength) + ' симв.');\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    inputTitle.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) + ' симв.');\n  } else {\n    inputTitle.setCustomValidity('');\n  }\n\n  inputTitle.reportValidity();\n})\n\n\ninputTypeHouse.addEventListener('change', () => {\n  inputPrice.placeholder = minPrice[inputTypeHouse.value];\n  inputPrice.min = minPrice[inputTypeHouse.value];\n  inputPrice.max = MAX_PRICE;\n});\n\ninputPrice.addEventListener('input', () => {\n  inputPrice.placeholder = minPrice[inputTypeHouse.value];\n  inputPrice.min = minPrice[inputTypeHouse.value];\n  inputPrice.max = MAX_PRICE;\n});\n\ninputsTime[0].addEventListener('click', () => {\n  inputsTime[1].value = inputsTime[0].value;\n});\n\ninputsTime[1].addEventListener('click', () => {\n  inputsTime[0].value = inputsTime[1].value;\n});\n\n\n\n//Валидация количество комнат и гостей\n\nconst inputRoomNumber = adForm.querySelector('#room_number');\nconst inputCapacity = adForm.querySelector('#capacity');\n\ninputRoomNumber.addEventListener('click', () => {\n  const room = +(inputRoomNumber.value);\n  const guest = +(inputCapacity.value);\n\n  if (room >= MAX_NUMBER_ROOMS && guest > NO_GUESTS) {\n    inputCapacity.setCustomValidity('Измените количество гостей или комнат');\n  } else if (room < MAX_NUMBER_ROOMS && guest === NO_GUESTS) {\n    inputCapacity.setCustomValidity('Выберите количество гостей');\n  } else if (room < guest && guest < MAX_NUMBER_ROOMS) {\n    inputCapacity.setCustomValidity('Измените количество гостей или комнат');\n  } else {\n    inputCapacity.setCustomValidity('');\n  }\n});\n\ninputCapacity.addEventListener('click', () => {\n  const room = +(inputRoomNumber.value);\n  const guest = +(inputCapacity.value);\n\n  if (room < MAX_NUMBER_ROOMS && guest > NO_GUESTS && room >= guest) {\n    inputCapacity.setCustomValidity('');\n  } else if (room >= MAX_NUMBER_ROOMS && guest === NO_GUESTS) {\n    inputCapacity.setCustomValidity('');\n  }\n\n  if (room >= MAX_NUMBER_ROOMS && guest > NO_GUESTS) {\n    inputCapacity.setCustomValidity('Измените количество гостей или комнат');\n  } else if (room < MAX_NUMBER_ROOMS && guest === NO_GUESTS) {\n    inputCapacity.setCustomValidity('Выберите количество гостей или комнат');\n  } else if (room < guest && guest < MAX_NUMBER_ROOMS) {\n    inputCapacity.setCustomValidity('Измените количество гостей или комнат');\n  }\n\n});\n\n\n\n//Зависимость значения поля с адресом и метки\n\nconst buttonReset = document.querySelector('.ad-form__reset');\nconst adFormAdress = adForm.querySelector('#address');\nadFormAdress.setAttribute('readonly', 'readonly');\n\nconst startAdress = mainMarker.getLatLng();\nconst startAdressField = `${startAdress.lat.toFixed(5)}, ${startAdress.lng.toFixed(5)}`;\nadFormAdress.value = startAdressField;\n\nmainMarker.on('drag', (evt) => {\n  adFormAdress.value = `${evt.target.getLatLng().lat.toFixed(5)}, ${evt.target.getLatLng().lng.toFixed(5)}`;\n});\n\nconst resetFormField = () => {\n  adForm.reset();\n  resetFilter();\n  adFormAdress.value = startAdressField;\n  mainMarker.setLatLng(startAdress);\n  resetImageForm();\n};\n\nbuttonReset.addEventListener('click', evt => {\n  evt.preventDefault();\n  resetFormField();\n});\n\n\nexport { adForm, resetFormField };\n","import { resetFormField } from './form.js';\n\nconst mainBlock = document.querySelector('main');\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\n\nconst showMessageOnSuccess = () => {\n  const popupSuccessTemplate = document.querySelector('#success').content.cloneNode(true);\n  const popupSuccess = document.createElement('div');\n  popupSuccess.appendChild(popupSuccessTemplate);\n  mainBlock.appendChild(popupSuccess);\n\n  const onPopupEscKeydown = (evt) => {\n    if (isEscEvent(evt)) {\n      evt.preventDefault();\n      closePopupSuccess();\n    }\n  };\n\n  const closePopupSuccess = () => {\n    resetFormField();\n    popupSuccess.classList.add('hidden');\n    document.removeEventListener('keydown', onPopupEscKeydown);\n  };\n\n\n  document.addEventListener('keydown', onPopupEscKeydown);\n\n  popupSuccess.addEventListener('click', () => {\n    closePopupSuccess();\n  });\n}\n\nconst showMessageOnFail = () => {\n  const popupErrorTemplate = document.querySelector('#error').content.cloneNode(true);\n  const popupError = document.createElement('div');\n  popupError.appendChild(popupErrorTemplate);\n  mainBlock.appendChild(popupError);\n\n  const buttonError = document.querySelector('.error__button');\n\n  const onPopupEscKeydown = (evt) => {\n    if (isEscEvent(evt)) {\n      evt.preventDefault();\n      closePopupError();\n    }\n  };\n\n  const closePopupError = () => {\n    popupError.classList.add('hidden');\n    document.removeEventListener('keydown', onPopupEscKeydown);\n  };\n\n  buttonError.addEventListener('click', () => {\n    closePopupError();\n  });\n\n  document.addEventListener('keydown', onPopupEscKeydown);\n\n  popupError.addEventListener('click', () => {\n    closePopupError();\n  });\n}\n\n\nexport { showMessageOnSuccess, showMessageOnFail };\n","import { adForm } from './form.js';\nimport { showMessageOnSuccess, showMessageOnFail } from './message-when-submit.js';\nimport { renderSimilarAd, disableFormFields } from './map.js';\nimport { filterForm } from './filter.js';\nimport { showAlert } from './util.js';\nimport { filterAds } from './filter.js';\n\n\nconst API_URL_FOR_GET_DATA = 'https://22.javascript.pages.academy/keksobooking/data';\nconst API_URL_FOR_FORM_SUBMIT = 'https://22.javascript.pages.academy/keksobooking';\n\n\nconst getData = onSuccess => {\n  fetch(API_URL_FOR_GET_DATA)\n    .then(response => response.json())\n    .then(ads => {\n      onSuccess(ads);\n    })\n    .catch(() => {\n      showAlert('.map__canvas', '100%', 'К сожалению, сервер не отвечает. Обновите страницу.');\n      disableFormFields(filterForm, 'map__filters--disabled');\n    });\n}\n\n\nconst setUserFormSubmit = (onSuccess, onFail) => {\n  adForm.addEventListener('submit', evt => {\n    evt.preventDefault();\n\n    const formData = new FormData(evt.target);\n\n    fetch(\n      API_URL_FOR_FORM_SUBMIT,\n      {\n        method: 'POST',\n        body: formData,\n      },\n    ).then(responseData => {\n      responseData.ok ? onSuccess(adForm) : onFail();\n    })\n      .catch(() => {\n        onFail();\n      });\n  });\n}\n\n\ngetData(ads => {\n  filterAds(ads, renderSimilarAd);\n});\n\nsetUserFormSubmit(showMessageOnSuccess, showMessageOnFail);\n","const getRandomNumber = (a = 0, b = 0, lengthRemainder = 0) => {\n  const remainder = Math.pow(10, lengthRemainder);\n  const min = Math.min(a, b) * remainder;\n  const max = Math.max(a, b) * remainder;\n  if (min < 0) {\n    return NaN;\n  }\n\n  return +(((Math.floor(Math.random() * (max - min + 1)) + min) / remainder).toFixed(lengthRemainder));\n};\n\nconst getRandomElemets = (array, min = 1) => {\n  const randomLength = getRandomNumber(min, array.length);\n  const newArray = [...array].sort(() => Math.random() - 0.5);\n  return newArray.slice(0, randomLength);\n};\n\n\nconst transformHtmlToNode = (element) => {\n  const wrapper = document.createElement('div');\n  wrapper.innerHTML = element;\n  return wrapper.firstChild;\n};\n\nconst showAlert = (placeClass, widthAlert, message) => {\n  const alertMessage = `<div style = \"z-index: 400; position: absolute; width: ${widthAlert};\n  padding: 10px 3px; font-size: 30px; text-align: center;\n  background-color: lightblue;\">${message}</div>`;\n\n  const nodeAlertMessage = transformHtmlToNode(alertMessage);\n  document.querySelector(placeClass).append(nodeAlertMessage);\n\n  setTimeout(() => {\n    nodeAlertMessage.remove();\n  }, 5000);\n};\n\nexport { getRandomNumber, getRandomElemets, showAlert };\n"],"sourceRoot":""}